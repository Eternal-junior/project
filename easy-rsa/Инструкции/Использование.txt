Приветствую, дорогой читать. В этом тесте предоcтавлена информация о работе консольной утилиты easy-rsa, которая является главным компонентом удостверяющего центра. Easy-RSA — это утилита для управления или инфраструктурой открытых ключей. Основная программа Easy-RSA — это скрипт, поддерживаемый парой конфигурационных файлов. Таким образом, формальная «установка» не требуется. Для работы используется скрипт easyrsa с учетной записи администратора, тк возможность зайти на сервер от root отсутствует. Рассмотрим полезные команды:                                                                            ./easyrsa init-pki - Создает базовую директорию для работы с инфрастурой открытых ключей в данной директории есть подкаталог private / - каталог с закрытыми ключами, сгенерированными на этом хосте и reqs/ — каталог с локально сгенерированными запросами на сертификаты (здесь хранятся импортированные запросы CA).
                             Чтобы подписывать запросы на создание сертификатов, вам нужен центр сертификации.
                Чтобы создать новый центр сертификации в созданной вами системе PKI, выполните следующие действия:
           ./easyrsa build-ca !!!Важно!!!Сгенерированный корневой сертификат сa.crt ни в коем случае нельзя удалять/потерять, тк он является основным компонентом УЦ, и без него нужно будет заново перевыпускать сертификаты.                     На данный сервер приходят запросы на подпись (реквесты) с VPN сервера, для их отработки необходимо выполнить скрипт start.sh, который найдет необходимый реквест, подпишет его и переместит в директорию, в которой файл make_config.sh соберет сертификат для клиента. Данный сертификат будет заархивирован и запаролен, и его нужно будет отправить конечному пользователю VPN услуги.
                                                          В случае поступления информации об увольнении сотрудника, необходимо выполнить команду:                                         ./easyrsa revoke user. Например, так отзывают сертификат для клиента user.                                      Срок действия данных сертификатов установлен 1 год, если необходимо продлить его для дальнейшего использования выполните команду:
              ./easyrsa renew user nopass. Если нужен закрытый ключ с паролем, нужно убрать nopass                            Посмотреть список ранее выданных сертификатов можно командой: cat pki/index.txt.
При переносе инфраструктуры открытых ключей на другой сервер, может загрузить dep пакет с удаленного репозитории и произвести настройку как указано выше, после чего обязательно положить ca.crt, который действует сейчас в директорию /.easy-rsa/pki , тк в противном случае новые сертификаты не будут подписаны.
Для подписания клиентскийх сертификатов (серверные тоже), можно использовать скрипт:
./start.sh Данные скрипт сгенерирует сертификат для ВПН сервера и перенесет его в запароленный архив (пароль нужно указать при работе скрипта. Также во время работы скрипта необходимо указать пастфразу для корневого сертификата.
Также на сервере действует антивирусная защита rkhanter, поэтому неоходимо проверять логи ошибок по его работе. Данная функция также предусмотрена в автоматических задачах раз в неделю, на ряду с обновлением всех пакетов (apt-get update).
Кроме того, должен сказать, что здесь включено логирование по использованию команды sudo, поэтому просьба использовать привилегии рута с умом.
                                                                                                                         Дорогой друг, надеюсь я рассказал достаточно информации для администрирования сервера удостверяющего центра. В случае возникновения новых вопросов, можно воспользоваться официальной документацией https://easy-rsa.readthedocs.io/en/latest/. Удачи и хорошей работы!)